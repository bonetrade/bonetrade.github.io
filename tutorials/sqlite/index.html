<!DOCTYPE html>
<html>
  <head>
    <title>The Bonetrade Project</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="generator" content="Hugo 0.39" />
<title>Setting up a SQLite DB :: The Bonetrade Project</title>
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/theme-flex/style.css" rel="stylesheet">

<link rel="stylesheet" href="/css/bootstrap.min.css">
<script src="/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
      var baseurl = "http:\/\/bonetrade.github.io";
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-117669422-1', 'auto');
  ga('send', 'pageview');

</script>

<script src="https://hypothes.is/embed.js" async></script>
    
  </head>
  <body data-url="/tutorials/sqlite/">
    
      <header>
  <div class="logo">
    
	
  
    <a class="baselink" href="http://bonetrade.github.io">The Bonetrade Project</a>
  

  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
    <nav class="shortcuts">
            <li class="" role="">
                <a href="https://github.com/bonetrade"  rel="noopener">
                  <i class='fa fa-github'></i> <label>Github</label>
                </a>
            </li>
            <li class="" role="">
                <a href="/info-sheet.pdf"  rel="noopener">
                  <i class='fa fa-cloud-download'></i> <label>Download Info Sheet</label>
                </a>
            </li>
            <li class="" role="">
                <a href="/scope"  rel="noopener">
                  <i class='fa fa-info-circle'></i> <label>Scope</label>
                </a>
            </li>
            <li class="" role="">
                <a href="/credits"  rel="noopener">
                  <i class='fa fa-bullhorn'></i> <label>Credits</label>
                </a>
            </li>
    </nav>
</header>
<article>
  <aside>
    <ul class="menu">
          <li data-nav-id="/" class="dd-item">
          <a href="/">
            <i class="fa fa-fw fa-home"></i>
          </a>
          </li>
    <li data-nav-id="/scope/" class="dd-item haschildren
        ">
      <div>
      <a href="/scope/">Scope</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/scope/schedule/" class="dd-item
        ">
      <div>
      <a href="/scope/schedule/">Schedule</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/scope/bibliography/" class="dd-item
        ">
      <div>
      <a href="/scope/bibliography/">Bibliography</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/scope/outputs/" class="dd-item
        ">
      <div>
      <a href="/scope/outputs/">Expectations for What We&#39;ll Learn</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/scope/graduate-opportunities/" class="dd-item
        ">
      <div>
      <a href="/scope/graduate-opportunities/">Graduate Opportunities</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/scope/end-of-project/" class="dd-item
        ">
      <div>
      <a href="/scope/end-of-project/">When This Project Ends</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/code/" class="dd-item
        ">
      <div>
      <a href="/code/">Code</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/papers/" class="dd-item
        ">
      <div>
      <a href="/papers/">Papers and Publications</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/tutorials/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/tutorials/">Tutorials</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/tutorials/blogdown/" class="dd-item
        ">
      <div>
      <a href="/tutorials/blogdown/">Building a Website with Blogdown</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/tutorials/scrapy-instagram/" class="dd-item
        ">
      <div>
      <a href="/tutorials/scrapy-instagram/">Scraping Instagram Post Metadata</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/tutorials/sqlite/" class="dd-item parent active
        ">
      <div>
      <a href="/tutorials/sqlite/">Setting up a SQLite DB</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/tutorials/sqlite-to-r/" class="dd-item
        ">
      <div>
      <a href="/tutorials/sqlite-to-r/">Importing SQLite DB into R</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/update/" class="dd-item haschildren
        ">
      <div>
      <a href="/update/">Updates</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/update/2018-04-30-using-etudier-to-jump-start-a-literature-review/" class="dd-item">
        <div>
          <a href="/update/2018-04-30-using-etudier-to-jump-start-a-literature-review/">
            Using Etudier to Jump Start a Literature Review
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/update/2018-04-16-getting-started/" class="dd-item">
        <div>
          <a href="/update/2018-04-16-getting-started/">
            Getting Started!
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>




    </ul>
    <section><center>

<a class="github-button" href="https://github.com/bonetrade/bonetrade.github.io/info-sheet.pdf" data-icon="octicon-cloud-download" aria-label="Download our infosheet on GitHub">Download</a>


<a class="github-button" href="https://github.com/bonetrade/bonetrade.github.io" data-icon="octicon-star" data-show-count="false" aria-label="Star bonetrade/bonetrade.github.io on GitHub">Star</a>


<a class="github-button" href="https://github.com/bonetrade/bonetrade.github.io/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork bonetrade/bonetrade.github.io on GitHub">Fork</a>

<p>Shawn Graham, Carleton University <br> Damien Huffer, Stockholm University <br><img src="/carleton-logo.png"><img src="/stockholm-logo.gif"> </p>

</center>

<script async defer src="https://buttons.github.io/buttons.js"></script>
    </section>
  </aside>
  <section class="page">
    
    <div class="nav-select">
      <center>Navigation : 
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/scope/" >
   Scope</option>
    <option value="/code/" >
   Code</option>
    <option value="/papers/" >
   Papers and Publications</option>
    <option value="/tutorials/" >
   Tutorials</option> 
    <option value="/tutorials/blogdown/" >
  - 
   Building a Website with Blogdown</option>
    <option value="/tutorials/scrapy-instagram/" >
  - 
   Scraping Instagram Post Metadata</option>
    <option value="/tutorials/sqlite/"  selected>
  - 
   Setting up a SQLite DB</option> 
  
    <option value="/tutorials/sqlite-to-r/" >
  - 
   Importing SQLite DB into R</option>
  
    <option value="/update/" >
   Updates</option>



        </select>
      </center>
    </div>
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="Search...">
        </div>
        <script type="text/javascript" src="/js/lunr.min.js"></script>
        <script type="text/javascript" src="/js/auto-complete.js"></script>
        <link href="/css/auto-complete.css" rel="stylesheet">
        <script type="text/javascript">
          
              var baseurl = "http:\/\/bonetrade.github.io";
          
        </script>
        <script type="text/javascript" src="/js/search.js"></script>
      </div>
    

    <h1>Setting up a SQLite DB</h1>
    
    
    



<p>The data that we scraped using Scrapy was output as json files. Json stands for &lsquo;JavaScript Object Notation&rsquo; and records values as attribute-data pairs and lists these pairs in arrays. Because we are not building a complex multi-faceted database, and we might want to expose this data for other kinds of uses later on (perhaps as our <a href="https://programminghistorian.org/lessons/creating-apis-with-python-and-flask">own API</a>), we are going to take that data and put it into a sqlite database.</p>

<p>This will also enable us to identify duplicate values (data that got captured via multiple searches or hashtags, for instance), extract and reshape the data for particular purposes, connect our data to R for subsequent analyses, and deposit the data in our data repo.</p>

<h2 id="requirements">Requirements</h2>

<ul>
<li><a href="https://sqlitebiter.readthedocs.io/en/latest/index.html">sqlitebiter</a> a python utility for ingesting a wide variety of data formats into an sqlite db</li>
<li>python</li>
</ul>

<p>First, set up a virtualenv:</p>

<pre><code>$ mkdir database-work
$ virtualenv database-work
$ source database-work/bin/activate
</code></pre>

<p>Install sqlitebiter:</p>

<pre><code>$ pip install sqlitebiter
</code></pre>

<p>This will install a bunch of other dependencies - which is why we&rsquo;re using a virtualenv, so that these dependencies don&rsquo;t conflict with other packages we&rsquo;re using.</p>

<h2 id="making-the-database">Making the database</h2>

<p>Assuming you have the concatenated file containing all of the results from the scrape as a properly formatted json file in the current folder,</p>

<pre><code>sqlitebiter file scrape-results.json -o scrape-results-current-date.sqlite
</code></pre>

<p>Then, to finish things up,</p>

<pre><code>$ sqlite3 scrape-results-current-date.sqlite
 &gt;&gt;&gt; .schema
 &gt;&gt;&gt; .exit
</code></pre>

<p>The <code>&gt;&gt;&gt;</code> on the command line show us we&rsquo;re inside sqlite. We could continue to work on the command line with sqlite, but sometimes a gui does make life easier. We&rsquo;ll use <a href="http://sqlitebrowser.org/">sqlitebrowser</a>. Download and install. Then, open the dbbrowser and open the database you just created.</p>

<p><img src="https://github.com/sqlitebrowser/sqlitebrowser/raw/master/images/sqlitebrowser.png" alt="Example screenshot of a typical DB-browser interface" /></p>

<p>Click &lsquo;browse data&rsquo; and you&rsquo;ll see the data in a clean table view. The data can be exported as csv. Here are some simple SQL queries we can run to do some common tasks for us. To run these, click &lsquo;execute sql&rsquo; and paste the query into the edit window. Once the query is there (these queries can also be saved and loaded from file) hit the &lsquo;run&rsquo; button to execute.</p>

<h3 id="example-queries">Example Queries</h3>

<p>A query to select distinct rows, that is to say, remove duplicate values:</p>

<pre><code>select distinct
id, caption, display_url, owner_name, taken_at_timestamp
from
scrape-results-current-date;
</code></pre>

<p>make a new table from those distint values:</p>

<pre><code>create table individual_posts
as 
select distinct id, caption, display_url, owner_name, taken_at_timestamp
from scrape-results-current-date;
</code></pre>

<p>select distinct rows by keyword in a field:</p>

<pre><code>select distinct
id, caption, display_url, owner_name, taken_at_timestamp
from
individual_posts
where caption like '%sale%';
</code></pre>

<p>convert unix timestamp to human-readable date</p>

<pre><code>UPDATE unique_posts SET taken_at_timestamp = datetime(taken_at_timestamp, 'unixepoch', 'localtime')
</code></pre>



    
    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="/tutorials/scrapy-instagram/" title="Scraping Instagram Post Metadata"> <i class="fa fa-chevron-left"></i><label>Scraping Instagram Post Metadata</label></a>
    <a class="nav nav-next" href="/tutorials/sqlite-to-r/" title="Importing SQLite DB into R" style="margin-right: 0px;"><label>Importing SQLite DB into R</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    

    

  

    <div class="github-link">
      <a href="https://github.com/bonetrade/bonetrade.github.io/Tutorials/Sqlite/_index.md" target="blank"><i class="fa fa-code-fork"></i>
        Improve this page</a>
    </div>
  </div>


	<div>


  
    <p><img src="https://raw.githubusercontent.com/bonetrade/bonetrade.github.io/master/_footer_files/SSHRC-CRSH_FIP.jpg" alt="SSHRC Logo" /></p>

<p>This research was supported by the Social Sciences and Humanities Research Council of Canada</p>

  



	</div>
</footer>

<script src="/js/clipboard.min.js"></script>

<link href="/css/featherlight.min.css" rel="stylesheet">
<script src="/js/featherlight.min.js"></script>



<script src="/theme-flex/script.js"></script>

    

    
    

    
  </body>
</html>