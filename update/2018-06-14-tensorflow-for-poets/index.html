<!DOCTYPE html>
<html>
  <head>
    <title>The Bonetrade Project</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="generator" content="Hugo 0.40.3" />
<title>Tensorflow for Poets :: The Bonetrade Project</title>
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/theme-flex/style.css" rel="stylesheet">

<link rel="stylesheet" href="/css/bootstrap.min.css">
<script src="/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
      var baseurl = "\/";
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-117669422-1', 'auto');
  ga('send', 'pageview');

</script>

<script src="https://hypothes.is/embed.js" async></script>
    
  </head>
  <body data-url="/update/2018-06-14-tensorflow-for-poets/">
    
      <header>
  <div class="logo">
    
	
  
    <a class="baselink" href="/">The Bonetrade Project</a>
  

  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
    <nav class="shortcuts">
            <li class="" role="">
                <a href="https://github.com/bonetrade"  rel="noopener">
                  <i class='fa fa-github'></i> <label>Github</label>
                </a>
            </li>
            <li class="" role="">
                <a href="/info-sheet.pdf"  rel="noopener">
                  <i class='fa fa-cloud-download'></i> <label>Download Info Sheet</label>
                </a>
            </li>
            <li class="" role="">
                <a href="/scope"  rel="noopener">
                  <i class='fa fa-info-circle'></i> <label>Scope</label>
                </a>
            </li>
            <li class="" role="">
                <a href="/credits"  rel="noopener">
                  <i class='fa fa-bullhorn'></i> <label>Credits</label>
                </a>
            </li>
    </nav>
</header>
<article>
  <aside>
    <ul class="menu">
          <li data-nav-id="/" class="dd-item">
          <a href="/">
            <i class="fa fa-fw fa-home"></i>
          </a>
          </li>
    <li data-nav-id="/scope/" class="dd-item haschildren
        ">
      <div>
      <a href="/scope/">Scope</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/scope/schedule/" class="dd-item
        ">
      <div>
      <a href="/scope/schedule/">Schedule</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/scope/bibliography/" class="dd-item
        ">
      <div>
      <a href="/scope/bibliography/">Bibliography</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/scope/outputs/" class="dd-item
        ">
      <div>
      <a href="/scope/outputs/">Expectations for What We&#39;ll Learn</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/scope/graduate-opportunities/" class="dd-item
        ">
      <div>
      <a href="/scope/graduate-opportunities/">Graduate Opportunities</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/scope/end-of-project/" class="dd-item
        ">
      <div>
      <a href="/scope/end-of-project/">When This Project Ends</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/papers/" class="dd-item haschildren
        ">
      <div>
      <a href="/papers/">Papers and Publications</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/papers/fields-02-19/" class="dd-item">
        <div>
          <a href="/papers/fields-02-19/">
            Slides: Workshop on Quantitative Analysis and the Digital Turn in Historical Studies
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/papers/cultpropcrime-06-18/" class="dd-item">
        <div>
          <a href="/papers/cultpropcrime-06-18/">
            Slides: Cultural Property Crime Seminar
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/tutorials/" class="dd-item haschildren
        ">
      <div>
      <a href="/tutorials/">Tutorials</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/tutorials/blogdown/" class="dd-item
        ">
      <div>
      <a href="/tutorials/blogdown/">Building a Website with Blogdown</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/tutorials/add-new-file/" class="dd-item
        ">
      <div>
      <a href="/tutorials/add-new-file/">Adding New Content Via Github</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/tutorials/scrapy-instagram/" class="dd-item
        ">
      <div>
      <a href="/tutorials/scrapy-instagram/">Scraping Instagram Post Metadata</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/tutorials/sqlite/" class="dd-item
        ">
      <div>
      <a href="/tutorials/sqlite/">Setting up a SQLite DB</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/tutorials/sqlite-to-r/" class="dd-item
        ">
      <div>
      <a href="/tutorials/sqlite-to-r/">Importing SQLite DB into R</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/tutorials/classify-images-with-tensorflow/" class="dd-item haschildren
        ">
      <div>
      <a href="/tutorials/classify-images-with-tensorflow/">Cluster Images with Tensorflow</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/tutorials/classify-images-with-tensorflow/affinity-propagation-in-r/" class="dd-item
        ">
      <div>
      <a href="/tutorials/classify-images-with-tensorflow/affinity-propagation-in-r/">Affinity Propagation in R</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/tutorials/tensorflow-for-poets/" class="dd-item
        ">
      <div>
      <a href="/tutorials/tensorflow-for-poets/">Build an Image Classifier with Tensorflow</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/update/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/update/">Updates</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/update/2019-02-24-learning-curve/" class="dd-item">
        <div>
          <a href="/update/2019-02-24-learning-curve/">
            Learning Curve
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/update/2018-07-29-dcgan-for-archaeologists/" class="dd-item">
        <div>
          <a href="/update/2018-07-29-dcgan-for-archaeologists/">
            DCGAN for Archaeologists
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/update/2018-06-14-tensorflow-for-poets/" class="dd-item active">
        <div>
          <a href="/update/2018-06-14-tensorflow-for-poets/">
            Tensorflow for Poets
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/update/2018-04-30-using-etudier-to-jump-start-a-literature-review/" class="dd-item">
        <div>
          <a href="/update/2018-04-30-using-etudier-to-jump-start-a-literature-review/">
            Using Etudier to Jump Start a Literature Review
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/update/2018-04-16-getting-started/" class="dd-item">
        <div>
          <a href="/update/2018-04-16-getting-started/">
            Getting Started!
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>




    </ul>
    <section><center>

<p>Shawn Graham, Carleton University <br> Damien Huffer, Stockholm University <br><img src="/carleton-logo.png"><img src="/stockholm-logo.gif"> </p>

</center>

<script async defer src="https://buttons.github.io/buttons.js"></script>
    </section>
  </aside>
  <section class="page">
    
    <div class="nav-select">
      <center>Navigation : 
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/scope/" >
   Scope</option>
    <option value="/papers/" >
   Papers and Publications</option>
    <option value="/tutorials/" >
   Tutorials</option>
    <option value="/update/" >
   Updates</option> 
      <option value="/update/2019-02-24-learning-curve/" >- Learning Curve</option>
      <option value="/update/2018-07-29-dcgan-for-archaeologists/" >- DCGAN for Archaeologists</option>
      <option value="/update/2018-06-14-tensorflow-for-poets/"  selected>- Tensorflow for Poets</option>
      <option value="/update/2018-04-30-using-etudier-to-jump-start-a-literature-review/" >- Using Etudier to Jump Start a Literature Review</option>
      <option value="/update/2018-04-16-getting-started/" >- Getting Started!</option>
  



        </select>
      </center>
    </div>
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="Search...">
        </div>
        <script type="text/javascript" src="/js/lunr.min.js"></script>
        <script type="text/javascript" src="/js/auto-complete.js"></script>
        <link href="/css/auto-complete.css" rel="stylesheet">
        <script type="text/javascript">
          
              var baseurl = "\/";
          
        </script>
        <script type="text/javascript" src="/js/search.js"></script>
      </div>
    

    <h1>Tensorflow for Poets</h1>
    
    
    
    <p>2018-06-14</p>

<p>In our recent paper, <a href="https://journal.caa-international.org/articles/10.5334/jcaa.8/">&lsquo;Fleshing Out the Bones&rsquo;</a> we used the trained &lsquo;Inception 3&rsquo; model as a way of determining clusters of images that we then studied for clues and hints: <em>why</em> did the machine cluster them this way? What are the common features?</p>

<p>Unsupervised learning: It&rsquo;s not unlike reading entrails.</p>

<p><img src="/update/2018-06-14-tensorflow-for-poets_files/219px-Piacenza_Bronzeleber.jpg" alt="Diagram of the sheep's liver found near Piacenza with Etruscan inscriptions on the bronze sheep's Liver of Piacenza, Wikipedia" /></p>

<p>An alternate approach is to take an existing model, and add new training data to it. Pete Warden put together a tutorial a few years ago called <a href="https://petewarden.com/2016/02/28/tensorflow-for-poets/">Tensorflow for Poets</a> that has since been formalized as a <a href="https://codelabs.developers.google.com/codelabs/tensorflow-for-poets/#0">Google CodeLabs tutorial</a>. Last night I tried the tutorial out using a corpus of Roman fabrics and wares. The nuts-and-bolts of doing this are over in the <a href="/tutorials/tensorflow-for-poets">tutorials</a>.</p>

<p>The hardest part was getting the training data organized. It needs to be in a folder where each image is in a subfolder where the name of the subfolder is the category, eg:</p>

<pre><code>|
|-training-images
  |
  |-terrasig
  |-african_red_slip
  |-veranice_nera
</code></pre>

<p>&hellip;etc. Once that was done, it went quite smoothly. What will take some <em>time</em> is figuring out what the different <code>architecture</code> and other flags do. For instance, in the default command suggested by the tutorial, I had to determine that I needed to add the flag on validation size and set it to use the entire training set (as my training set is probably way too small).</p>

<pre><code>python -m scripts.retrain \
  --bottleneck_dir=tf_files/bottlenecks \
  --how_many_training_steps=500 \
  --model_dir=tf_files/models/ \
  --summaries_dir=tf_files/training_summaries/mobilenet_0.50_224 \
  --output_graph=tf_files/retrained_graph.pb \
  --output_labels=tf_files/retrained_labels.txt \
  --architecture mobilenet_0.50_224 \
  --validation_batch_size=-1 \
  --image_dir=tf_files/gallery
</code></pre>

<blockquote>
<p>&ldquo;The architecture flag is where we tell the retraining script which version of MobileNet we want to use. The 1.0 corresponds to the width multiplier, and can be 1.0, 0.75, 0.50 or 0.25. The 224 corresponds to image resolution, and can be 224, 192, 160 or 128. For example, to train the smallest version, youâ€™d use &ndash;architecture mobilenet_0.25_128.&rdquo; <a href="https://hackernoon.com/creating-insanely-fast-image-classifiers-with-mobilenet-in-tensorflow-f030ce0a2991">Harvey, 2017</a></p>
</blockquote>

<p>I&rsquo;m not sure I understand exactly what this all means yet, practically speaking. Anyway, I now know what I&rsquo;ll need our MA research assistants to do this fall.</p>

<ol>
<li>study our first corpus&rsquo; clustering results to come up with some training categories</li>
<li>divide that corpus into a training dataset</li>
<li>train a new image classifier</li>
<li>run that classifier on our new corpus (which I&rsquo;m still collecting)</li>
<li>compare that with the clustering approach without our new classifier.</li>
<li>compare the results of both with the posts&rsquo; text</li>
</ol>

<p>The ambition? To be able to sort at scale the images we find automatically into sensible structure.</p>


    
    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="/update/2018-07-29-dcgan-for-archaeologists/" title="DCGAN for Archaeologists"> <i class="fa fa-chevron-left"></i><label>DCGAN for Archaeologists</label></a>
    <a class="nav nav-next" href="/update/2018-04-30-using-etudier-to-jump-start-a-literature-review/" title="Using Etudier to Jump Start a Literature Review" style="margin-right: 0px;"><label>Using Etudier to Jump Start a Literature Review</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    

    

  
    <div class="date">
        <i class='fa fa-calendar'></i> Last update on 14/06/2018
    </div>
    

    <div class="github-link">
      <a href="https://github.com/bonetrade/bonetrade.github.io/update/2018-06-14-tensorflow-for-poets.md" target="blank"><i class="fa fa-code-fork"></i>
        Improve this page</a>
    </div>
  </div>


	<div>


  
    <p><img src="https://raw.githubusercontent.com/bonetrade/bonetrade.github.io/master/_footer_files/SSHRC-CRSH_FIP.jpg" alt="SSHRC Logo" /></p>

<p>This research was supported by the Social Sciences and Humanities Research Council of Canada</p>

  



	</div>
</footer>

<script src="/js/clipboard.min.js"></script>

<link href="/css/featherlight.min.css" rel="stylesheet">
<script src="/js/featherlight.min.js"></script>



<script src="/theme-flex/script.js"></script>

    

    
    

    
  </body>
</html>